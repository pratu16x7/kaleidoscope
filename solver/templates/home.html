{% extends "base.html" %}

{% macro grid_pattern(grid, classname) -%}
  <div class="grid {{classname}}">
    {% for row in grid %}
    <div class="grid-row">
      {% for cell in row %}
      <div class="grid-cell 
        {% if cell == None %} white 
        {% elif cell['color'] == 'r' %} red 
        {% else %} black 
        {% endif %}
        
        {% if cell %}
          {% if cell['edges'][0] == '1' %} up {% endif %}
          {% if cell['edges'][1] == '1' %} left {% endif %}
          {% if cell['edges'][2] == '1' %} down {% endif %}
          {% if cell['edges'][3] == '1' %} right {% endif %}
        {% endif %}
        "> 
        {% if cell.rel_coord is defined %}
          {{ cell['rel_coord'] }}
        {% else %}
          {{ cell['coord'] }}
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% endfor %}
  </div>
{%- endmacro %}


{% block content %}
  {{ grid_pattern(data.grid, 'board') }}
  
  <h3>Data</h3>
  <div class="data">
    Red: {{ data.red_count }}
    Black: {{ data.black_count }}
    Total: {{ data.total_count }}
  </div>
  
  <h3>Holes, smallest first</h3>
  {% for key, hole in holes.items() %}
    {{ grid_pattern(hole.grid, 'piece') }}
  {% endfor %}
  
  <h3>Windows</h3>
  {% for coord, window in windows.items() %}
    {{ grid_pattern(window.grid, 'piece') }}
    {% for piece in window.possible_pieces %}
      {{ piece }}
      {{ grid_pattern(get_piece(piece['name'], piece['orient']).grid, 'piece') }}
    {% endfor %}
    <p>-------</p>
  {% endfor %}
  
  <h3>Pieces</h3>
  {% for piece_set in piece_sets %}
    {% for piece in piece_set %}
      {{ grid_pattern(piece.grid, 'piece') }}
    {% endfor %}
    <p>Done</p>
  {% endfor %}
{% endblock %}

